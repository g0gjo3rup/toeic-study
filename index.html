<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOEIC 30å¤©å¯¦æˆ°ç‰¹è¨“ (å«æ¸¬é©—åŠŸèƒ½)</title>
    <style>
    :root {
        --primary: #2c3e50;
        --accent: #27ae60;
        --wrong: #e74c3c;
        --bg: #fdfbf7;
        --text: #333;
        --note-bg: #fff8e1;
        --note-border: #fae588;
    }
    /* æ ¸å¿ƒä¿®æ”¹ï¼šbody å–æ¶ˆé‚Šè·ï¼Œè®“å…§å®¹è²¼é½Šæ‰‹æ©Ÿé‚Šç·£ */
    body { font-family: "Microsoft JhengHei", sans-serif; background: var(--bg); color: var(--text); padding: 0; line-height: 1.5; margin: 0; }
    
    /* æ ¸å¿ƒä¿®æ”¹ï¼šå®¹å™¨å¯¬åº¦ 100% æ»¿ç‰ˆï¼Œæ¶ˆé™¤å·¦å³å…©å´ç©ºç™½ */
    .container { width: 100%; max-width: 100%; margin: 0; background: #fff; padding: 15px; box-sizing: border-box; border-radius: 0; box-shadow: none; }
    
    h1 { color: var(--primary); text-align: center; border-bottom: 2px solid var(--primary); padding-bottom: 10px; margin: 10px 0 20px 0; font-size: 1.4em; }
    .tabs { display: flex; border-bottom: 2px solid #ddd; margin-bottom: 20px; }
    .tab { flex: 1; text-align: center; padding: 12px 0; cursor: pointer; font-weight: bold; color: #7f8c8d; border-bottom: 3px solid transparent; }
    .tab.active { color: var(--primary); border-bottom-color: var(--primary); }
    .view-section { display: none; }
    .view-section.active { display: block; }

    /* æ§åˆ¶å€èª¿æ•´ç‚ºæ»¿ç‰ˆæŒ‰éˆ• */
    .controls { display: flex; gap: 10px; flex-direction: column; background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px solid #eee; }
    select, button { padding: 12px; font-size: 16px; border-radius: 4px; border: 1px solid #ccc; width: 100%; box-sizing: border-box; }
    .btn-primary { background: var(--primary); color: white; border: none; font-weight: bold; }
    .btn-accent { background: var(--accent); color: white; border: none; font-weight: bold; }
    
    .word-list { list-style: none; padding: 0; margin: 0; }
    .word-item { padding: 20px 0; border-bottom: 1px solid #eee; width: 100%; }
    
    /* å–®å­—æ’ç‰ˆï¼šåŠ å¤§è‹±æ–‡ï¼Œç·Šæ¹Šæ’åˆ— */
    .word-header { display: flex; align-items: baseline; flex-wrap: wrap; gap: 8px; margin-bottom: 8px; }
    .en-word { font-size: 1.7em; font-weight: bold; color: var(--primary); }
    .phonetic { color: #7f8c8d; font-family: Arial; font-size: 1em; }
    .pos-tag { color: #95a5a6; font-style: italic; font-weight: bold; font-size: 0.9em; }
    .ch-meaning { font-size: 1.3em; color: #c0392b; font-weight: bold; }
    .stars { color: #f1c40f; font-size: 1em; margin-right: 5px; }
    .btn-audio { background: #f0f2f5; border: 1px solid #ddd; border-radius: 50%; cursor: pointer; width: 32px; height: 32px; display: inline-flex; align-items: center; justify-content: center; }

    /* å»¶ä¼¸å…§å®¹ï¼šå¼·åˆ¶ 100% æ»¿ç‰ˆå¯¬åº¦ */
    .word-rel { background: #f0f2f5; padding: 10px; border-radius: 4px; font-size: 0.95em; color: #555; margin: 10px 0; border-left: 5px solid #bdc3c7; width: 100%; box-sizing: border-box; }
    .sentence-box { background: var(--note-bg); border: 1px solid var(--note-border); padding: 12px; border-radius: 6px; width: 100%; box-sizing: border-box; }
    .en-sent { display: block; font-weight: 500; color: #333; margin-bottom: 5px; font-size: 1.05em; }
    
    /* æ¸¬é©—å€å¡ç‰‡æ»¿ç‰ˆ */
    .quiz-card { background: #fff; padding: 20px; margin-bottom: 15px; border-radius: 8px; border: 1px solid #eee; width: 100%; box-sizing: border-box; }
    .quiz-options { display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 15px; }
    .option-btn { padding: 15px; border: 2px solid #ddd; border-radius: 6px; cursor: pointer; text-align: left; width: 100%; box-sizing: border-box; }
    .option-btn.selected { background: var(--primary); color: white; }

    #importModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 100; }
    .modal-content { background: #fff; padding: 20px; border-radius: 8px; width: 90%; }
    textarea { width: 100%; height: 200px; margin: 15px 0; padding: 10px; box-sizing: border-box; }
</style>

</head>
<body>
<div class="container">
    <h1>TOEIC 30å¤©å¯¦æˆ°ç‰¹è¨“ PRO</h1>
    <div class="tabs">
        <div class="tab active" onclick="switchTab('study')">ğŸ“– èƒŒå–®å­—</div>
        <div class="tab" onclick="switchTab('quiz')">âš”ï¸ å¯¦æˆ°æ¸¬é©—</div>
    </div>
    <div id="studySection" class="view-section active">
        <div class="controls">
            <select id="daySelector" onchange="renderWords()"></select>
            <button class="btn-primary" onclick="openImport()">+ åŒ¯å…¥è³‡æ–™</button>
        </div>
        <ul class="word-list" id="wordList"></ul>
    </div>
    <div id="quizSection" class="view-section">
        <div class="controls" id="quizStartScreen">
            <select id="quizScopeSelector"></select>
            <button class="btn-accent" onclick="startQuiz()">é–‹å§‹æ¸¬é©—</button>
        </div>
        <div id="quizArea" style="display:none;"></div>
        <div id="quizControls" style="display:none; text-align:center; margin-top:20px;"><button class="btn-accent" onclick="submitQuiz()" style="padding:15px 60px;">äº¤å·</button></div>
        <div id="quizResult" style="display:none;">
            <div id="resultList"></div>
            <button class="btn-primary" onclick="resetQuiz()" style="width:100%; margin-top:20px; padding:15px;">å†è©¦ä¸€æ¬¡</button>
        </div>
    </div>
</div>
<div id="importModal"><div class="modal-content"><h3>åŒ¯å…¥ JSON è³‡æ–™</h3><textarea id="importInput"></textarea><div style="text-align:right;"><button onclick="closeImport()">å–æ¶ˆ</button><button class="btn-accent" onclick="saveImport()">ç¢ºèªåŒ¯å…¥</button></div></div></div>

<script>
    let db = {};
    const themes = {"1":"Day 01: é›‡ç”¨/é¢è©¦","2":"Day 02: å·¥ä½œå…§å®¹","3":"Day 03: è–ªè³‡ç¦åˆ©","4":"Day 04: åœ˜éšŠåˆä½œ","5":"Day 05: å…¥è·è¦å®š","6":"Day 06: æœè£è¦å®š","7":"Day 07: éŠ·å”®ç­–ç•¥","8":"Day 08: åœ‹éš›è¡ŒéŠ·","9":"Day 09: ç¶“æ¿Ÿè¶¨å‹¢","10":"Day 10: è³¼ç‰©é«˜æ‰‹","11":"Day 11: ç”¢å“é–‹ç™¼","12":"Day 12: ç”Ÿç”¢ç®¡ç†","13":"Day 13: é¡§å®¢æœå‹™","14":"Day 14: æ—…éŠå·®æ—…","15":"Day 15: å•†æ¥­è²¿æ˜“","16":"Day 16: ç‰©æµé…é€","17":"Day 17: é£¯åº—é¤é£²","18":"Day 18: è²¡æ”¿æœƒè¨ˆ","19":"Day 19: å…¬å¸å‹•å‘","20":"Day 20: å•†å‹™æœƒè­°","21":"Day 21: äº¤é€šé‹è¼¸","22":"Day 22: éŠ€è¡Œæ¥­å‹™","23":"Day 23: æŠ•è³‡ç†è²¡","24":"Day 24: å»ºç¯‰ä½å®…","25":"Day 25: ç’°å¢ƒæ°£è±¡","26":"Day 26: é†«ç™‚å¥åº·","27":"Day 27: ç¤¾äº¤æ–‡åŒ–","28":"Day 28: é›»è…¦ç§‘æŠ€","29":"Day 29: æ³•å¾‹äº‹å‹™","30":"Day 30: ç¤¾æœƒæ”¿åºœ"};

    function init() {
        const saved = localStorage.getItem('toeicProV2'); // æ”¹å› V2ï¼Œæ•‘å›è³‡æ–™
        if (saved) { try { db = JSON.parse(saved); } catch(e){} }
        updateMenus();
        const firstDay = Object.keys(db).sort((a,b)=>Number(a)-Number(b))[0];
        if(firstDay) { document.getElementById('daySelector').value = firstDay; renderWords(); }
    }

    function updateMenus() {
        const dSel = document.getElementById('daySelector');
        const qSel = document.getElementById('quizScopeSelector');
        dSel.innerHTML = ""; qSel.innerHTML = "";
        const days = Object.keys(db).map(Number).sort((a,b)=>a-b);
        days.forEach(d => {
            dSel.add(new Option(themes[d] || `Day ${d}`, d));
            qSel.add(new Option(`æ¸¬é©— Day ${d}`, d));
        });
        for(let i=1; i<=26; i+=5) { if(days.some(d => d>=i && d<=i+4)) qSel.add(new Option(`Day ${i}-${i+4} è¤‡ç¿’`, `${i}-${i+4}`)); }
    }

    function renderWords() {
        const d = document.getElementById('daySelector').value;
        const list = document.getElementById('wordList');
        list.innerHTML = ""; if(!db[d]) return;
        db[d].forEach(item => {
            const li = document.createElement('li');
            li.className = "word-item";
            li.innerHTML = `
                <div class="word-header">
                    <span class="en-word">${item.w}</span>
                    <button class="btn-audio" onclick="playAudio('${item.w}')">ğŸ”Š</button>
                    <span class="phonetic">${item.p || ""}</span>
                    <span class="pos-tag">${item.pos}</span>
                    <span class="stars">${"â˜…".repeat(item.s || 1)}</span>
                    <span class="ch-meaning">${item.m}</span>
                </div>
                ${item.rel ? `<div class="word-rel">${item.rel}</div>` : ""}
                <div class="sentence-box">${item.ex}<br><span style="color:#7f8c8d;">${item.ch}</span></div>`;
            list.appendChild(li);
        });
    }

    function playAudio(t) { window.speechSynthesis.cancel(); const u = new SpeechSynthesisUtterance(t); u.lang='en-US'; u.rate=0.8; window.speechSynthesis.speak(u); }
    function switchTab(t) {
        document.querySelectorAll('.tab').forEach(x => x.classList.remove('active'));
        document.querySelectorAll('.view-section').forEach(x => x.classList.remove('active'));
        if(t==='study') { document.querySelector('.tab:nth-child(1)').classList.add('active'); document.getElementById('studySection').classList.add('active'); }
        else { document.querySelector('.tab:nth-child(2)').classList.add('active'); document.getElementById('quizSection').classList.add('active'); }
    }

    let curQ = []; let userAns = {};
    function startQuiz() {
        let pool = []; const s = document.getElementById('quizScopeSelector').value;
        if(s==='all') Object.values(db).forEach(v=>pool=pool.concat(v));
        else if(s.includes('-')){ const [st,en]=s.split('-').map(Number); for(let i=st;i<=en;i++) if(db[i]) pool=pool.concat(db[i]); }
        else pool = db[s] || [];
        if(pool.length < 4) return alert("å–®å­—é‡ä¸è¶³");
        curQ = shuffle([...pool]).slice(0, 15).map(t => {
            const dis = shuffle(pool.filter(w=>w.w!==t.w)).slice(0,3).map(d=>d.w);
            return {q: `ã€Œ${t.m}ã€çš„è‹±æ–‡æ˜¯ï¼Ÿ`, c: t.w, opts: shuffle([t.w,...dis]), data: t};
        });
        userAns = {}; document.getElementById('quizStartScreen').style.display='none';
        document.getElementById('quizArea').style.display='block'; document.getElementById('quizArea').innerHTML="";
        document.getElementById('quizControls').style.display='block';
        curQ.forEach((q, i) => {
            const div = document.createElement('div'); div.className='quiz-card';
            div.innerHTML = `<div>${i+1}. ${q.q}</div><div class="quiz-options">${q.opts.map(o=>`<div class="option-btn" onclick="userAns[${i}]='${o}'; this.parentElement.querySelectorAll('.option-btn').forEach(b=>b.classList.remove('selected')); this.classList.add('selected');">${o}</div>`).join('')}</div>`;
            document.getElementById('quizArea').appendChild(div);
        });
    }

    function submitQuiz() {
        let sc = 0; let html = "";
        curQ.forEach((q, i) => {
            const isC = userAns[i] === q.c; if(isC) sc++;
            html += `<div class="quiz-card" style="border-left:5px solid ${isC?'green':'red'}">Q${i+1}. æ­£è§£: <b>${q.c}</b><br><small>${q.data.m}</small></div>`;
        });
        document.getElementById('resultList').innerHTML = html;
        document.getElementById('quizArea').style.display='none'; document.getElementById('quizControls').style.display='none'; document.getElementById('quizResult').style.display='block';
    }
    function resetQuiz(){ document.getElementById('quizStartScreen').style.display='flex'; document.getElementById('quizResult').style.display='none'; }
    function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }
    function openImport(){ document.getElementById('importModal').style.display='flex'; }
    function closeImport(){ document.getElementById('importModal').style.display='none'; }
    function saveImport(){ try { const d = JSON.parse(document.getElementById('importInput').value); db = {...db, ...d}; localStorage.setItem('toeicProV2', JSON.stringify(db)); updateMenus(); closeImport(); renderWords(); alert("åŒ¯å…¥æˆåŠŸ"); } catch(e){ alert("éŒ¯èª¤"); } }
    init();
</script>
</body>
</html>
